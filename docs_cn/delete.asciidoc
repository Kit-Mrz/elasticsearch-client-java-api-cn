[[java-docs-delete]]
=== 删除 API

删除 API 允许用户根据文档 ID 删除特定索引中一个类型化的 JSON 文档。下面的示例从索引 twitter 中删除类型 tweet、文档 ID 为 1 的 JSON 文档:

[source,java]
--------------------------------------------------
DeleteResponse response = client.prepareDelete("twitter", "tweet", "1").get();
--------------------------------------------------

更多关于删除操作的信息, 请查看 https://www.elastic.co/guide/en/elasticsearch/reference/5.2/docs-delete.html[删除 API] 文档。

[[java-docs-delete-by-query]]
=== 根据查询删除 API

根据查询删除 API 允许用户删除根据查询结果得到文档集合:

[source,java]
--------------------------------------------------
BulkIndexByScrollResponse response =
    DeleteByQueryAction.INSTANCE.newRequestBuilder(client)
        .filter(QueryBuilders.matchQuery("gender", "male")) <1>
        .source("persons")                                  <2>
        .get();                                             <3>

long deleted = response.getDeleted();                       <4>
--------------------------------------------------
<1> 查询
<2> 索引
<3> 执行操作
<4> 删除的文档数量

因为它是一个耗时比较长的操作, 所以如果你想要异步执行, 你可以调用 `execute` 方法来替代 `get` 方法并提供一个像下面这样的监听器:

[source,java]
--------------------------------------------------
DeleteByQueryAction.INSTANCE.newRequestBuilder(client)
    .filter(QueryBuilders.matchQuery("gender", "male"))                  <1>
    .source("persons")                                                   <2>
    .execute(new ActionListener<BulkIndexByScrollResponse>() {           <3>
        @Override
        public void onResponse(BulkIndexByScrollResponse response) {
            long deleted = response.getDeleted();                        <4>
        }
        @Override
        public void onFailure(Exception e) {
            // Handle the exception
        }
    });
--------------------------------------------------
<1> 查询
<2> 索引
<3> 监听器
<4> 删除的文档数量
